<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Move Buss · Mobilidade Urbana</title>
  <link rel="icon" href="assets/logo.png" />
  <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
  <link rel="stylesheet" href="styles.css" />
  <!-- Firebase SDKs (v9+ modular CDN) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>
</head>
<body>
  <div id="app" class="app">
    <!-- Topbar -->
    <header class="topbar">
      <div class="topbar-left">
        <img src="assets/logo.png" class="logo" alt="Move Buss logo" />
        <div class="brand">
          <div class="brand-title">Move <span class="accent">Buss</span></div>
          <div class="brand-sub">Mobilidade Urbana</div>
        </div>
      </div>
      <div class="topbar-center">
        <button id="btnToggleMenu" class="btn ghost" title="Menu">☰</button>
        <div id="userBadge" class="user-badge hidden"></div>
      </div>
      <div class="topbar-right">
        <button id="btnChangePassword" class="btn outline hidden">Alterar senha</button>
        <button id="btnLogout" class="btn solid hidden">Deslogar</button>
      </div>
    </header>

    <!-- Side menu -->
    <nav id="sideMenu" class="sidemenu">
      <button class="sidemenu-item" data-view="abastecimento">Abastecimento</button>
      <button class="sidemenu-item" data-view="relatorios">Relatórios</button>
    </nav>

    <!-- Main content -->
    <main class="content">

      <!-- LOGIN -->
      <section id="viewLogin" class="card view">
        <h2>Login</h2>
        <p class="muted">Entre com sua <b>matrícula</b> e <b>senha</b>.</p>
        <form id="formLogin" class="grid">
          <label>Matrícula
            <input id="loginMatricula" type="text" required inputmode="numeric" maxlength="8" />
          </label>
          <label>Senha
            <input id="loginSenha" type="password" required />
          </label>
          <div class="row">
            <button type="submit" class="btn solid">Entrar</button>
            <button type="button" id="goRegister" class="btn outline">Registrar</button>
          </div>
        </form>
      </section>

      <!-- REGISTRO -->
      <section id="viewRegister" class="card view hidden">
        <h2>Criar conta</h2>
        <form id="formRegister" class="grid">
          <label>Matrícula
            <input id="regMatricula" type="text" required inputmode="numeric" maxlength="8" />
          </label>
          <label>Nome completo
            <input id="regNome" type="text" required />
          </label>
          <label>Senha
            <input id="regSenha" type="password" required minlength="6" />
          </label>
          <div class="row">
            <button type="submit" class="btn solid">Registrar</button>
            <button type="button" id="goLogin" class="btn outline">Voltar ao login</button>
          </div>
        </form>
        <p class="muted small">Ao criar conta você concorda em manter seus dados profissionais (matrícula, nome) no sistema.</p>
      </section>

      <!-- DASHBOARD -->
      <section id="viewDashboard" class="view hidden">
        
        <!-- Caixa Controls -->
        <div class="row gap">
          <div class="card">
            <h3>Status do Caixa</h3>
            <div id="caixaStatus" class="big"></div>
            <div class="row">
              <button id="btnAbrirCaixa" class="btn solid">Abrir Caixa</button>
              <button id="btnFecharCaixa" class="btn outline hidden">Fechar Caixa</button>
            </div>
          </div>

          <div class="card">
            <h3>Sangria</h3>
            <form id="formSangria" class="grid">
              <label>Valor a ser sangrado (R$)
                <input id="sangriaValor" type="number" step="0.01" min="0" placeholder="0,00" />
              </label>
              <label>Motivo da sangria
                <input id="sangriaMotivo" type="text" maxlength="120" />
              </label>
              <button type="submit" class="btn outline">Solicitar sangria</button>
            </form>
            <p class="muted small">Requer aprovação de um administrador nos relatórios.</p>
          </div>
        </div>

        <!-- Abastecimento -->
        <div id="cardAbastecimento" class="card hidden">
          <h3>Gerar Recibo (Abastecimento)</h3>
          <form id="formAbastecimento" class="grid">
            <label>Tipo de validador
              <select id="tipoValidador" required>
                <option value="">Selecione...</option>
                <option value="PRODATA">PRODATA</option>
                <option value="DIGICON">DIGICON</option>
              </select>
            </label>
            <label>Quantidade de bordos
              <input id="qtdBordos" type="number" min="1" step="1" required />
            </label>
            <label>Valor (R$)
              <input id="valor" type="number" step="0.01" min="0" required readonly />
            </label>
            <label>Prefixo
              <div class="prefixo">
                <span>55</span>
                <input id="prefixo" type="text" inputmode="numeric" maxlength="3" required placeholder="___" />
              </div>
            </label>
            <label>Data do caixa
              <input id="dataCaixa" type="date" required />
            </label>
            <label>Matrícula Motorista
              <input id="matMotorista" type="text" inputmode="numeric" required />
            </label>
            <label>Matrícula Recebedor
              <input id="matRecebedor" type="text" inputmode="numeric" required readonly />
            </label>
            <button class="btn solid" type="submit">Salvar e imprimir</button>
          </form>
        </div>

        <!-- Relatórios -->
        <div id="cardRelatorios" class="card hidden">
          <div class="row space-between">
            <h3>Relatórios de Caixa</h3>
            <div class="row gap">
              <label class="inline">Filtrar por dia
                <input id="filterDia" type="date" />
              </label>
              <button id="btnFiltrar" class="btn ghost">Filtrar</button>
            </div>
          </div>
          <div id="listaRelatorios"></div>
        </div>

      </section>

      <!-- Recibo oculto para impressão -->
      <section id="printArea" class="receipt hidden"></section>

    </main>

    <footer class="footer">
      © <span id="year"></span> Move Buss · Mobilidade Urbana
    </footer>
  </div>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyAxQliXm59BRg9zsVpK5qthB0nowqU0GEg",
      authDomain: "lancamentomanual-6cac4.firebaseapp.com",
      projectId: "lancamentomanual-6cac4",
      storageBucket: "lancamentomanual-6cac4.firebasestorage.app",
      messagingSenderId: "710102934933",
      appId: "1:710102934933:web:a5dc954d01d40518a5c29c",
      measurementId: "G-MLLXPXR7EC"
    };
  </script>
  <script src="app.js"></script>
</body>
</html>
